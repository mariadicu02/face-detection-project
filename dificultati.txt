
Documentatie depanare Moodle local pe Raspberry Pi

ğŸ” ProblemÄƒ Ã®ntÃ¢lnitÄƒ:
La accesarea platformei Moodle de pe Raspberry Pi, Ã®n browserul local (http://localhost/moodle), pagina rÄƒmÃ¢nea blocatÄƒ la Ã®ncÄƒrcare, fÄƒrÄƒ rÄƒspuns (timeout). Eroarea afiÈ™atÄƒ anterior era:
This site canâ€™t be reached â€“ 192.168.X.X took too long to respond.
ERR_CONNECTION_TIMED_OUT

ğŸ“Œ Cauze identificate:
1. Moodle fusese configurat anterior Ã®ntr-o altÄƒ reÈ›ea Wi-Fi.
2. FiÈ™ierul config.php conÈ›inea o adresÄƒ IP veche, care nu mai era valabilÄƒ Ã®n reÈ›eaua curentÄƒ.
3. Apache era activ, dar Moodle nu se Ã®ncÄƒrca din cauza acelui redirect invalid.

âœ… SoluÈ›ii aplicate pas cu pas:

1. Verificare reÈ›ea È™i IP curent Raspberry Pi:
   ip a
   â†’ IP activ pe wlan0 a fost 192.168.0.101

2. Verificare funcÈ›ionare Apache:
   sudo systemctl status apache2
   â†’ Apache era activ.

3. Verificare fiÈ™iere site:
   ls /var/www/html/
   â†’ Exista folderul moodle, deci Moodle era instalat.

4. Testare localÄƒ Ã®n browser:
   - http://localhost â†’ pagina Apache OK
   - http://localhost/moodle â†’ se bloca, fÄƒrÄƒ Ã®ncÄƒrcare

5. Verificare prezenÈ›Äƒ fiÈ™ier config.php:
   ls /var/www/html/moodle/config.php

6. Editare fiÈ™ier config.php pentru a corecta adresa de server:
   sudo nano /var/www/html/moodle/config.php
   â†’ Linia modificatÄƒ:
   $CFG->wwwroot = 'http://localhost/moodle';

7. Salvare È™i reÃ®ncÄƒrcare Ã®n browser:
   - DupÄƒ modificare, http://localhost/moodle a Ã®nceput sÄƒ funcÈ›ioneze corect.

ğŸ“¦ Concluzii:
- Moodle funcÈ›ioneazÄƒ corect pe Raspberry Pi, atÃ¢t timp cÃ¢t config.php conÈ›ine o adresÄƒ validÄƒ pentru server.
- La schimbarea reÈ›elei, este necesarÄƒ actualizarea $CFG->wwwroot din config.php dacÄƒ adresa IP se modificÄƒ.
- Alternativ, se poate folosi http://localhost/moodle pentru acces local, fÄƒrÄƒ grija modificÄƒrii IP-ului.


DocumentaÈ›ie tehnicÄƒ â€” Sistem automat de prezenÈ›Äƒ facialÄƒ cu Moodle
âœ… FuncÈ›ionalitate generalÄƒ
Acest script:

DetecteazÄƒ feÈ›ele studenÈ›ilor Ã®n timp real prin camerÄƒ.

RecunoaÈ™te studentul pe baza imaginilor din poze/.

MarcheazÄƒ prezenÈ›a Ã®n sesiunea activÄƒ din Moodle prin API REST.

ğŸ“¦ CerinÈ›e
Python 3.x

OpenCV, dlib, requests, numpy

FiÈ™iere .dat pentru recunoaÈ™tere facialÄƒ

FiÈ™ier studenti.json cu structura: { "NumeStudent": { "id": MOODLE_ID, ... } }

ğŸ” Integrare cu Moodle
Web services activate Ã®n Moodle

Pluginul Attendance instalat

Token activ pentru un user cu rol profesor

ğŸ“² API Moodle folosit
core_course_get_contents â€“ pentru a gÄƒsi activitatea de tip Attendance

mod_attendance_get_sessions â€“ pentru a gÄƒsi sesiunea activÄƒ

mod_attendance_get_user_statuses â€“ pentru a obÈ›ine statusul â€Pâ€ (Prezent)

mod_attendance_update_user_status â€“ pentru a marca prezenÈ›a studentului

âš ï¸ Probleme Ã®ntÃ¢lnite
Token-ul trebuie generat cu permisiuni suficiente.

Serverul local trebuie accesibil la adresa din MOODLE_URL.

FeÈ›ele din poze/ trebuie sÄƒ fie clare È™i bine aliniate.



===============================
DOCUMENTAÈšIE ERORI MOODLE
===============================

Scop:
-----
Documentarea completÄƒ a problemelor Ã®ntÃ¢mpinate Ã®n integrarea sistemului de recunoaÈ™tere facialÄƒ cu Moodle,
precum È™i soluÈ›iile aplicate pentru rezolvarea acestora. InformaÈ›iile de mai jos sunt esenÈ›iale pentru
mentenanÈ›a viitoare È™i Ã®nÈ›elegerea modului de funcÈ›ionare al sistemului.

1. PROBLEMA: Eroare 403 - Forbidden
-----------------------------------
Simptome:
- La rularea scriptului `test_moodle_connection.py` apÄƒrea mesajul:
  "[âŒ] Eroare HTTP: 403"
- Ãn browser: "Access to 192.168.0.101 was denied. You don't have authorisation to view this page."

InvestigaÈ›ii:
- Verificare configurare token Ã®n Moodle (Site administration > Server > Web services > Manage tokens)
- Confirmare cÄƒ token-ul era valid, asociat unui utilizator administrator, È™i nu avea restricÈ›ii IP.
- Testarea directÄƒ a URL-ului Ã®n browser a returnat mesajul de interdicÈ›ie de acces.

Diagnostic final:
- Moodle avea web services activate, DAR protocolul REST nu era activat.

SoluÈ›ie:
1. Autentificare ca administrator Ã®n Moodle.
2. Navigare la: Site administration > Plugins > Web services > Manage protocols
3. Activare protocol REST (bifarea casetei corespunzÄƒtoare).

Rezultat:
- DupÄƒ aceastÄƒ acÈ›iune, URL-ul testat Ã®n browser a Ã®nceput sÄƒ returneze un JSON valid cu informaÈ›ii despre site.

---

2. PROBLEMA: Token valid dar fÄƒrÄƒ acces la web service
-------------------------------------------------------
Simptome:
- Scriptul de autentificare returna erori de tip:
  "[ERROR] Moodle request failed: Expecting value: line 1 column 1 (char 0)"
- Ãn logul Apache apÄƒrea eroarea:
  "The server died because the web services or the REST protocol are not enable"

Diagnostic:
- DeÈ™i token-ul era valid, funcÈ›iile web service nu erau active Ã®n serviciul asociat token-ului.

SoluÈ›ie:
1. Verificare Ã®n: Site administration > Server > Web services > External services
2. Selectare serviciu asociat token-ului (ex: AttendanceService)
3. Verificare È™i adÄƒugare funcÈ›ii necesare (ex: core_webservice_get_site_info, mod_attendance_*)

---

3. PROBLEMA: FuncÈ›iile nu apÄƒreau Ã®n rÄƒspunsul de test
------------------------------------------------------
Simptome:
- FuncÈ›iile precum `mod_attendance_get_sessions` sau `mod_attendance_update_user_status` nu erau disponibile.

SoluÈ›ie:
1. Navigare Ã®n Moodle la:
   Site administration > Server > Web services > External services > [AttendanceService]
2. ApÄƒsare pe â€œAdd functionsâ€ È™i adÄƒugare manualÄƒ a funcÈ›iilor necesare.

Verificare:
- Rulare din nou a `test_moodle_connection.py`
- Confirmare primire rÄƒspuns JSON valid cu lista completÄƒ a funcÈ›iilor incluse.

---

Concluzie:
----------
Toate problemele Ã®ntÃ¢mpinate au fost legate de configurarea incompletÄƒ a serviciului REST Ã®n Moodle.
Diagnosticul a fost posibil prin combinarea:
- TestÄƒrii URL-urilor direct Ã®n browser.
- ConsultÄƒrii logurilor Apache (`/var/log/apache2/error.log`)
- VerificÄƒrii setÄƒrilor din interfaÈ›a de administrare Moodle.
- CreÄƒrii unui script de test dedicat (`test_moodle_connection.py`) pentru confirmarea rÄƒspunsurilor serverului.

DupÄƒ activarea corectÄƒ a protocolului REST, configurarea serviciului web È™i adÄƒugarea funcÈ›iilor necesare,
comunicarea Ã®ntre sistemul local (Raspberry Pi) È™i Moodle a funcÈ›ionat corect.

